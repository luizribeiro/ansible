---
- name: Allow DNS queries from IoT
  ufw:
    rule: allow
    from: 192.168.2.0/24
    port: "53"
    protocol: udp
- name: Allow Samba access from iot-mariner
  ufw:
    rule: allow
    from: 192.168.2.240
    port: "{{ item.port }}"
    protocol: "{{ item.protocol }}"
  with_items:
    - { port: 137, protocol: "tcp" }
    - { port: 137, protocol: "udp" }
    - { port: 138, protocol: "tcp" }
    - { port: 138, protocol: "udp" }
    - { port: 139, protocol: "tcp" }
    - { port: 139, protocol: "udp" }
    - { port: 445, protocol: "tcp" }
